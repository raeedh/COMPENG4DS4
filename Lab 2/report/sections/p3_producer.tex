%% LaTeX2e file `./sections/p3_producer.tex'
%% generated by the `filecontents' environment
%% from source `lab2' on 2023/03/03.
%%
\begin{lstlisting}[language=c,caption=Problem 3 Producer Task, label=list:p3_prod]
void producer_sem(void *pvParameters) {
    SemaphoreHandle_t *semaphores = (SemaphoreHandle_t*) pvParameters;
    SemaphoreHandle_t producer1_semaphore = semaphores[0];
    SemaphoreHandle_t producer2_semaphore = semaphores[1];
    SemaphoreHandle_t consumer_semaphore = semaphores[2];
    BaseType_t status1, status2;

    printf("please enter a string\n");
    scanf("%s", usr_str);

    while (1) {
        status1 = xSemaphoreTake(consumer_semaphore, portMAX_DELAY);
        status2 = xSemaphoreTake(consumer_semaphore, portMAX_DELAY);

        if (status1 != pdPASS || status2 != pdPASS) {
            PRINTF("Failed to acquire consumer_semaphore\r\n");
            while (1)
                ;
        }

        xSemaphoreGive(producer1_semaphore);
        xSemaphoreGive(producer2_semaphore);
        vTaskDelay(1000 / portTICK_PERIOD_MS);
    }

}
\end{lstlisting}
