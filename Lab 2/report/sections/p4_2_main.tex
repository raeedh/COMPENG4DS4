%% LaTeX2e file `./sections/p4_2_main.tex'
%% generated by the `filecontents' environment
%% from source `lab2' on 2023/03/03.
%%
\begin{lstlisting}[language=c,caption=Problem 4.2 main, label=list:p4_2_main]
typedef struct {
SemaphoreHandle_t sem;

int counter;
} wasd_handler;

int main(void) {
    BaseType_t status;
    /* Init board hardware. */
    BOARD_InitBootPins();
    BOARD_InitBootClocks();
    BOARD_InitDebugConsole();

    SemaphoreHandle_t my_sem = xSemaphoreCreateBinary();

    int my_counter = 0;
    wasd_handler my_wasd = { my_sem, my_count };
    wasd_handler *my_wasd_ptr = &my_wasd;

    xSemaphoreGive(my_sem);

    status = xTaskCreate(producer_event, "producer", 200, (void*) semaphores, 2, NULL);
    if (status != pdPASS) {
        PRINTF("Task creation failed!.\r\n");
        while (1)
            ;
    }
    status = xTaskCreate(consumer_event, "consumer", 200, (void*) semaphores, 2, NULL);
    if (status != pdPASS) {
        PRINTF("Task creation failed!.\r\n");
        while (1)
            ;
    }
    vTaskStartScheduler();
    while (1) {
    }
}
\end{lstlisting}
