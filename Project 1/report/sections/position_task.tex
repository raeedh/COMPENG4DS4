%% LaTeX2e file `./sections/position_task.tex'
%% generated by the `filecontents' environment
%% from source `project1' on 2023/03/17.
%%
\begin{lstlisting}[language=c,caption=Position Task, label=list:position]
void positionTask(void *pvParameters) {
    // Position task implementation
    BaseType_t status;
    int servoInput;
    float servoDutyCycle;

    while (1) {
        status = xQueueReceive(angle_queue, (void*) &servoInput, portMAX_DELAY);

        if (status != pdPASS) {
            PRINTF("Queue Receive failed!.\r\n");

            while (1)
                ;
        }

        if (prevServoInput != servoInput) {
            prevServoInput = servoInput;
            servoDutyCycle = servoInput * 0.025f / 45.0f + 0.078;
            updatePWM_dutyCycle(FTM_CHANNEL_SERVO_MOTOR, servoDutyCycle);
            FTM_SetSoftwareTrigger(FTM_MOTOR, true);
        }

        vTaskDelay(1 / portTICK_PERIOD_MS);
    }
}
\end{lstlisting}
