%% LaTeX2e file `./sections/p4_2_consumer.tex'
%% generated by the `filecontents' environment
%% from source `lab2' on 2023/03/03.
%%
\begin{lstlisting}[language=c,caption=Problem 4.2 Consumer Task, label=list:p4_2_cons]
void consumer_event(void *pvParameters) {
    wasd_handler *my_sem = (wasd_handler *)pvParameters;
    BaseType_t status;

    while (1) {
        xSemaphoreGive(consumer_semaphore);
        status = xSemaphoreTake(producer1_semaphore, portMAX_DELAY);
        if (status != pdPASS) {
            PRINTF("Failed to acquire producer1_semaphore\r\n");
            while (1)
                ;
        }
        switch (my_sem->counter) {
        case '0':
            PRINTF("left\r\n");
            vTaskDelay(1000 / portTICK_PERIOD_MS);
            break;
        case '1':
            PRINTF("right\r\n");
            vTaskDelay(1000 / portTICK_PERIOD_MS);
            break;
        case '2':
            PRINTF("up\r\n");
            vTaskDelay(1000 / portTICK_PERIOD_MS);
            break;
        case '3':
            PRINTF("down\r\n");
            vTaskDelay(1000 / portTICK_PERIOD_MS);
            break;
        }
    }
}
\end{lstlisting}
