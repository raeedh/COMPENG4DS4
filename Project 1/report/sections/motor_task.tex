%% LaTeX2e file `./sections/motor_task.tex'
%% generated by the `filecontents' environment
%% from source `project1' on 2023/03/17.
%%
\begin{lstlisting}[language=c,caption=Motor Task, label=list:motor]
void motorTask(void *pvParameters) {
    // Motor task implementation
    BaseType_t status;
    int motorInput;
    float motorDutyCycle;

    while (1) {
        status = xQueueReceive(motor_queue, (void*) &motorInput, portMAX_DELAY);

        if (status != pdPASS) {
            PRINTF("Queue Receive failed!.\r\n");

            while (1)
                ;
        }

        if (prevMotorInput != motorInput) {
            prevMotorInput = motorInput;
            motorDutyCycle = motorInput * 0.025f / 100.0f + 0.0760;
            updatePWM_dutyCycle(FTM_CHANNEL_DC_MOTOR, motorDutyCycle);
            FTM_SetSoftwareTrigger(FTM_MOTOR, true);
        }

        vTaskDelay(1 / portTICK_PERIOD_MS);
    }
}
\end{lstlisting}
