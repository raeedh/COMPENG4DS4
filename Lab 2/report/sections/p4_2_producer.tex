%% LaTeX2e file `./sections/p4_2_producer.tex'
%% generated by the `filecontents' environment
%% from source `lab2' on 2023/03/03.
%%
\begin{lstlisting}[language=c,caption=Problem 4.2 Producer Task, label=list:p4_2_prod]
void producer_event(void *pvParameters) {
    wasd_handler *my_sem = (wasd_handler *)pvParameters;

    BaseType_t status1,
    char c;

    while (1) {
        status1 = xSemaphoreTake(my_sem->sem, portMAX_DELAY);


        if (status1 != pdPASS) {
            PRINTF("Failed to acquire consumer_semaphore\r\n");

            while (1)
                ;
        }

        while (1) {
            scanf("%c", &c);

            switch (c) {
            case 'a':
                xSemaphoreGive(my_sem->sem);
                vTaskDelay(1000 / portTICK_PERIOD_MS);
                my_sem -> counter = 0;
                break;
            case 'd':
                xSemaphoreGive(my_sem->sem);
                vTaskDelay(1000 / portTICK_PERIOD_MS);
                my_sem -> counter = 1;
                break;
            case 'w':
                xSemaphoreGive(my_sem->sem);
                vTaskDelay(1000 / portTICK_PERIOD_MS);
                my_sem -> counter = 2;
                break;
            case 's':
                xSemaphoreGive(pmy_sem->sem);
                vTaskDelay(1000 / portTICK_PERIOD_MS);
                my_sem -> counter = 3;
                break;
            }
        }
    }
}
\end{lstlisting}
